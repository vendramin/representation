\section{Hurwitz' theorem}

\index{Fibonacci identity}
\index{Euler identity}
\index{Hamilton identity}
We know that $x^2y^2=(xy)^2$ holds for all $x,y\in\R$. Fibonacci
found the identity
\begin{equation}
\label{eq:2squares}
	(x_1^2+x_2^2)(y_1^2+y_2^2)=(x_1y_1-x_2y_2)^2+(x_1y_2-x_2y_1)^2.
\end{equation}
Euler and Hamilton independently found 
a similar identity:
\[
	(x_1^2+x_2^2+x_3^2+x_4^2)(y_1^2+y_2^2+y_3^2+y_4^2)=z_1^2+z_2^2+z_3^2+z_4^2,
\]
where
\begin{equation}
\label{eq:Hamilton}
\begin{aligned}
	 z_1&=x_1y_1-x_2y_2-x_3y_3-x_4y_4,\\
	 z_2&=x_1y_2+x_2y_1+x_3y_4-x_4y_3,\\
	 z_3&=x_1y_3-x_2y_4+x_3y_1+x_4y_2,\\ 
	 z_4&=x_1y_4+x_2y_3-x_3y_2+x_4y_1.
\end{aligned}
\end{equation}
Cayley found a similar identity for sums of eight squares. 
Are there other identities of this type? Hurwitz
proved that this is not the case. 

The question can be reformulated as follows. For which $n$ does there 
exist a bilinear map $\R^n\times\R^n\to\R^n$, 
$(x,y)\mapsto xy$, such that
\[
\|xy\|=\|x\|\|y\|
\]
for all $x,y\in\R^n$? Here, of course, we use the 
standard notation
\[
\|(x_1,\dots,x_n)\|=\sqrt{x_1^2+\cdots+x_n^2}.
\]

 \begin{lemma}
 \label{lem:hurwitz_group}
 	Let $n>2$ be an even number. If 
 	there exists a group $G$ with generators
 	$\epsilon,x_1,\dots,x_{n-1}$ and relations 
 	\[
 		x_1^2=\cdots=x_{n-1}^2=\epsilon\ne1,\quad
 		\epsilon^2=1,\quad
 		[x_i,x_j]=\epsilon\quad\text{if}\quad i\ne j,
 	\]
 	then the following statements hold:
 	\begin{enumerate}
 		\item $|G|=2^n$.
 		\item $[G,G]=\{1,\epsilon\}$. In particular, $G$ 
 		    has exactly $2^{n-1}$ degree-one representations. 
 		\item If $g\not\in Z(G)$, then the conjugacy class of $g$ is $\{g,\epsilon g\}$.
 		\item $Z(G)=\{1,\epsilon,x_1\cdots x_{n-1},\epsilon x_1\cdots x_{n-1}\}$. 
 		\item $G$ has $2^{n-1}+2$ conjugacy classes.
 		\item $G$ has two irreducible representations of degree $2^{\frac{n-2}{2}}>1$. 
 	\end{enumerate}
 \end{lemma}

 \begin{proof}
     Let us prove 1) and 2). Note that $\epsilon\in Z(G)$, as
     $\epsilon=x_i^2$ for all 
 	$i\in\{1,\dots,n-1\}$. Since $n-1>2$, $[x_1,x_2]=\epsilon$. Hence 
 	$\epsilon\in [G,G]$. Moreover, $G/\langle\epsilon\rangle$ is abelian. Thus 
 	$[G,G]=\langle \epsilon\rangle$. Since $G/[G,G]$ is elementary 
 	abelian of order 
 	$2^{n-1}$, it follows that 
 	$|G|=2^n$. 

 	We now prove 3). Let $g\in G\setminus Z(G)$ and 
 	$x\in G$ be such that $[x,g]\ne 1$. Then $[x,g]=\epsilon$ and 
 	$xgx^{-1}=\epsilon g$. 

 	To prove 4) let $g\in G$. Write
 	\[
 		g=\epsilon^{a_0}x_1^{a_1}\cdots x_{n-1}^{a_{n-1}},
 	\]
 	where $a_j\in\{0,1\}$ for all $j\in\{1,\dots,n-1\}$. 
 	If $g\in Z(G)$, then $gx_i=x_ig$ for all $i$. Hence 
 	$g\in Z(G)$ if and only if 
 	\[
 		\epsilon^{a_0}x_1^{a_1}\cdots x_{n-1}^{a_{n-1}}=x_i(\epsilon^{a_0}x_1^{a_1}\cdots x_{n-1}^{a_{n-1}})x_i^{-1}.
 	\]
 	Since $x_ix_j^{a_j}x_i=\epsilon^{a_j}x_j^{a_j}$ 
 	whenever $i\ne j$ and $\epsilon\in Z(G)$, the element $g$ is 
 	central if and only if 
 	\[
 		\sum_{\substack{j=1\\j\ne i}}^{n-1}a_j\equiv 0\bmod 2
 	\]
 	for all $i\in\{1,\dots,n-1\}$. In particular, 
 	\[
 	\sum_{j\ne i}a_j\equiv \sum_{j\ne k}a_j
 	\]
 	for all $k\ne i$. Therefore $a_i\equiv a_k\bmod 2$ for all 
 	$i,k\in\{1,\dots,n-1\}$. Thus $a_1=\cdots=a_{n-1}$ and  
 	$Z(G)=\{1,x_1\cdots x_{n-1},\epsilon,\epsilon x_1\cdots
 	x_{n-1}\}$. 
	
     To prove 5) we use the class equation:
     \[
 		2^n=|G|=|Z(G)|+\sum_{i=1}^N2=4+2N. 
 	\]
 	It follows that $G$ has $N+4=2^{n-1}+2$ conjugacy classes.
	
 	Finally we prove 6). 
 	Since $G$ 
 	has exactly $2^{n-1}$ degree-one representations (because 
 	$|G/[G,G]|=2^{n-1}$) and 
 	has $2^{n-1}+2$ conjugacy classes, 
 	it follows from 
 	\[
 		2^n=|G|=\underbrace{1+\cdots+1}_{2^{n-1}}+f_1^2+f_2^2=2^{n-1}+f_1^2+f_2^2,
 	\]
 	that $G$ has two irreducible representations
 	of degrees $f_1=f_2=2^{\frac{n-2}{2}}>1$. 
 \end{proof}

 \begin{example}
 	The formulas~\eqref{eq:Hamilton} give a representation for the
 	group $G$ of the previous lemma. Write each $z_i$ as 
 	\[
    z_i=\sum_{k=1}^4a_{1k}(x_1,\dots,x_4)y_k.
    \]
    Let $A$ be a matrix
 	such that 
 	$A_{ij}=a_{ij}(x_1,\dots,x_4)$, that is 
 	\[
 		A=\begin{pmatrix}
 			x_1 & -x_2 & -x_3 & -x_4\\
 			x_2 & x_1 & -x_4 & x_3\\
 			x_3 & x_4 & x_1 & -x_2\\
 			x_4 & -x_3 & x_2 & x_1
 		\end{pmatrix}.
 	\]
 	The matrix $A$ can be written as $A=A_1x_1+A_2x_2+A_3x_3+A_4x_4$, where
 	\begin{align*}
 		&A_1=\begin{psmallmatrix}
 		1\\
 		&1\\
 		&&1\\
 		&&&1\\
 		\end{psmallmatrix},
 		&&
 		A_2=\begin{psmallmatrix}
 			& -1\\
 			1 \\
 			&&&-1\\
 			&&1
 		\end{psmallmatrix},
 		&&
 		A_3=\begin{psmallmatrix}
 			&& -1 \\
 			&&&1 & \\
 			1\\
 			&-1
 		  \end{psmallmatrix},
 		  &&
 		  A_4=\begin{psmallmatrix}
 			&&&-1\\
 			&&-1\\
 			&1\\
 			1
 		\end{psmallmatrix}.
 	\end{align*}
 	For $i\in\{1,\dots,4\}$ let $B_i=A_i^TA_4$. Then
 	$B_i=-B_i^T$ and  $B_i^2=-I$ 
 	for all $i\in\{1,2,3\}$. Moreover, $B_iB_j=-B_jB_i$ for all $i,j\in\{1,2,3\}$ and
 	$i\ne j$.  
 	The group generated by $\{B_1,B_2,B_3\}$ has $2^3$ element, all of them
 	of the form
 	\[
 		\pm B_1^{k_1}B_2^{k_2}B_3^{k_3}
 	\]
 	for $k_j\in\{0,1\}$. 
     The map 
 	$G\to\langle B_1,B_2,B_3\rangle$,
 	\[
 		x_1\mapsto B_1,\quad
 		x_2\mapsto B_2,\quad
 		x_3\mapsto B_3 
 	\]
 	extends to a group isomomorphism. 
 \end{example}

\begin{theorem}[Hurwitz]
	\index{Hurwitz theorem}
    \label{thm:Hurwitz}
	If there is an identity of the form 
	\begin{equation}
		\label{eq:Hurwitz}
		(x_1^2+\cdots+x_n^2)(y_1^2+\cdots+y_n^2)=z_1^2+\cdots+z_n^2,
	\end{equation}
	where the $x_j$'s and the $y_j$'s are real numbers and
	each $z_k$ is a bilinear function in the $x_j$'s and the $y_j$'s, then 
	$n\in\{1,2,4,8\}$.
\end{theorem}

\begin{proof}
    Without loss of generality, we may assume that $n>2$.  For 
	$i\in\{1,\dots,n\}$ let  
	\[
		z_i=\sum_{k=1}^n a_{ik}(x_1,\dots,x_n)y_k,
	\]
	where the $a_{ik}$'s are linear functions. Then 
	\[
		z_i^2=\sum_{k,l=1}^na_{ik}(x_1,\dots,x_n)a_{il}(x_1,\dots,x_n)y_ky_l
	\]
	for all $i\in\{1,\dots,n\}$. Using these expressions for each $z_i$
	in~\eqref{eq:Hurwitz} and comparing coefficients, 
	\begin{equation}
		\label{eq:delta}
		\sum_{i=1}^n a_{ik}(x_1,\dots,x_n)a_{il}(x_1,\dots,x_n)=\delta_{k,l}(x_1^2+\cdots+x_n^2),
	\end{equation}
	where $\delta_{k,l}$ is the usual Kronecker's map. Let 
	$A$ be the $n\times n$ matrix given by 
	\[
	A_{ij}=a_{ij}(x_1,\dots,x_n).
	\]
	Then 
	\begin{equation}
		\label{eq:AAT}
		AA^T=(x_1^2+\cdots+x_n^2)I,
	\end{equation}
	where $I$ denotes the $n\times n$ identity matrix, 
	as 
	\[
		(AA^T)_{kl}=\sum_{i=1}^na_{ki}(x_1,\dots,x_n)a_{li}(x_1,\dots,x_n)=\delta_{kl}(x_1^2+\cdots+x_n^2)
	\]
	by~\eqref{eq:delta}. Since each $a_{ki}(x_1,\dots,x_n)$ is a linear function, 
	there exist $\alpha_{ij1},\dots,a_{ijn}\in\C$ such that 
	\[
		a_{ij}(x_1,\dots,x_n)=\alpha_{ij1}x_1+\cdots+\alpha_{ijn}x_n.
	\]
	Write 
	\[
		A=A_1x_1+\cdots+A_nx_n,
	\]
	where each $A_k$ is the matrix $(A_k)_{ij}=\alpha_{ijk}$. 
	The formula~\eqref{eq:AAT} becomes
	\[
		\sum_{i=1}^n\sum_{j=1}^nA_iA_j^Tx_ix_j=(x_1^2+\cdots+x_n^2)I.
	\]
	Thus 
	\begin{equation}
		\label{eq:condiciones}
		A_iA_j^T+A_jA_i^T=0\quad i\ne j,\quad
		A_iA_i^T=I.
	\end{equation}
	We need $n$ complex square matrices of size $n\times n$
	satisfying~\eqref{eq:condiciones}. For $i\in\{1,\dots,n\}$ let  
	$B_i=A_n^TA_i$. Then~\eqref{eq:condiciones} turn into  
	\[
		B_iB_j^T+B_jB_i^T=0\quad i\ne j,\quad
		B_iB_i^T=I,\quad
		B_n=I.
	\]
	Set $j=n$ in the first family of equations to obtain $B_i=-B_i^T$ for all 
	$i\in\{1,\dots,n-1\}$. It follows that 
	\begin{equation}
	\label{eq:representation}
	\begin{aligned}
	    &B_i^2=-I && \text{for all $i\in\{1,\dots,n-1\}$},\\
	    &[B_i,B_j]=-I && \text{for all $i,j\in\{1,\dots,n-1\}$.}
	\end{aligned}
	\end{equation}
    
    \begin{claim}
        $n$ is even. 
    \end{claim}
    
	Computing the determinant of 
	$B_iB_j=-B_jB_i$ we obtain that 
	\[
	1=\det(B_iB_j)=(-1)^n\det(B_jB_i)=(-1)^n.
	\]
	Hence $n$ is even. 

	\begin{claim}
	    The group 
	    $G$ of the lemma admits a faithful
	    representation $\rho\colon G\to\GL_n(\C)$. 
	\end{claim}
	
	By \eqref{eq:representation}, there is a well-defined 
	injective group homomorphism $\rho$ such that 
	$x_i\mapsto B_i$ for all $i\in\{1,\dots,n-1\}$ and 
	$\epsilon\mapsto -I$. 
	
	\begin{claim}
	    $2^{\frac{n-2}{2}}$ divides $n$.
	\end{claim}
	
	Since $\epsilon\in[G,G]$ by Lemma~\ref{lem:hurwitz_group}, 
	every one-dimensional representation satisfies $\epsilon\mapsto 1$.
	This implies that $\rho$ cannot have degree-one sub representations. 
	In fact, 
	if $W=\langle w\rangle$ is $G$-invariant subspace of $\C^n$, 
	then $\psi=\rho|_W\colon G\to\GL(W)\simeq\C^\times$ 
	is a representation. In particular, 
	\[
	-w=-Iw=\psi_{\epsilon}(w)=\psi_{[x_i,x_j]}(w)
	=\psi_{x_i}\psi_{x_j}\psi_{{x_i}}^{-1}\psi_{{x_j}}^{-1}(w)=w, 
	\]
	a contradiction. 
	
	This means that the $\C[G]$-module $\C^n$ 
	decomposes as $\C^n\simeq aS\oplus bT$,
	where $a$ and $b$ are integers and 
	$S$ and $T$ are simple $\C[G]$-modules of dimension
	$2^{\frac{n-2}{2}}$. In particular, 
	\[
	n=\dim V=\dim(aS\oplus bT)=(a+b)2^{\frac{n-2}{2}}.
	\]
	
	To finish the proof of the theorem, write $n=2^ab$ 
	for $a\geq1$ and $b$ an odd integer. 
	Since $\frac{n-2}{2}$ divides $n$, 
	\[
	2^{\frac{n}{2}-1}=2^{\frac{n-2}{2}}\leq n=2^ab. 
	\]
	Thus $\frac{n}{2}-1\leq a$ and hence $2^a\leq n\leq 2(a+1)$. 
	It follows that $n\in\{4,8\}$.  
\end{proof}

We now present an application, see
\cite{MR1534187} for more information. 

\begin{theorem}
	Let $V$ be a real vector space (with an inner product) 
	such that $\dim
	V=n\geq3$. If there exists a bilinear function 
	$V\times V\to\R$, $(v,w)\mapsto v\times
	w$, such that $v\times w$ is orthogonal both 
	to $v$ and $w$ and 
	\[
		\|v\times w\|^2=\|v\|^2\|w\|^2-\langle v,w\rangle^2,
	\]
	where $\|v\|^2=\langle v,v\rangle$, then $n\in\{3,7\}$. 
\end{theorem}

\begin{proof}
	Let $W=V\oplus\R$ with the inner product  
	\[
		\langle (v_1,r_1),(v_2,r_2)\rangle = \langle v_1,v_2\rangle+r_1r_2.
	\]
	Note that
	\begin{align*}
		\langle v_1\times &v_2+r_1v_2+r_2v_1,v_1\times v_2+r_1v_2+r_2v_1\rangle\\
		&=\|v_1\times v_2\|^2+r_1^2\|v_2\|^2+2r_1r_2\langle v_1,v_2\rangle+r_2^2\|v_1\|^2.
	\end{align*}
	Thus  
	\begin{align*}
		(\|v_1\|^2+r_1^2)&(\|v_2\|^2+r_2)\\
		&= \|v_1\|^2\|v_2\|^2+r_2^2\|v_1\|^2+r_1^2\|v_2\|^2+r_1^2r_2^2\\
		&=\|v_1\times v_2+r_1v_1+r_2v_2\|^2-2r_1r_2\langle v_1,v_2\rangle+\langle v_1,v_2\rangle^2+r_1^2r_2^2\\
		&=\|v_1\times v_2+r_1v_1+r_2v_2\|^2+(\langle v_1,v_2\rangle-r_1r_2)^2\\
		&=z_1^2+\cdots+z_{n+1}^2,
	\end{align*}
	where the $z_k$'s are bilinear functions in $(v_1,r_1)$ and $(v_2,r_2)$. 
	By Hurwitz's theorem, 
	$n+1\in\{4,8\}$. Hence $n\in\{3,7\}$.
\end{proof}

In the theorem, if $\dim V=3$, we obtain the usual cross product. 
If $\dim V=7$, let 
\[
	W=\{(v,k,w):v,w\in V,k\in\R\}
\]
with the inner product 
\[
	\langle (v_1,k_1,w_1),(v_2,k_2,w_2)\rangle = \langle v_1,v_2\rangle+k_1k_2+\langle w_1,w_2\rangle.
\]
It is an exercise to show that 
\begin{multline*}
	(v_1,k_1,w_1)\times (v_2,k_2,w_2)\\
	=(k_1w_2-k_2w_1+v_1\times v_2-w_1\times w_2,
	\\-\langle v_1,w_2\rangle+\langle v_2,w_1\rangle, 
	k_2v_1-k_1v_2-v_1\times w_2-w_1\times v_2)
\end{multline*}
satisfies the properties of the theorem. 

