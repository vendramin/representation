\section{Lecture: Week 9}
 
\begin{definition}
  \index{Frobenius!kernel}
  Let $G$ be a Frobenius group. The normal subgroup 
  $N$ of Frobenius' theorem is called the \emph{Frobenius kernel}. 
\end{definition}

\begin{proposition}
\label{pro:Frobenius_groups}
  Let $G$ be a Frobenius group with complement $H$. 
  Then there exists a normal subgroup $N$ of $G$ 
  such that 
  $G=HN$ and $H\cap N=\{1\}$.
\end{proposition}

\begin{proof}
  Frobenius' theorem yields the subgroup $N$. Since 
  $H\cap gHg^{-1}=\{1\}$ for all $g\in G\setminus H$, 
  it follows that 
  $N_G(H)=H$. It follows that $H$
  has $(G:H)$ conjugates. 
  Let 
  \[
  N=\left( G\setminus\bigcup_{x\in G}xHx^{-1}\right)\cup\{1\}.
  \]
  Then  
  $|N|=|G|-(G:H)(|H|-1)=(G:H)$.
  Since, moreover, $N\cap H=\{1\}$, we conclude that
  \[
  |HN|=|N||H|/|H\cap N|=|N||H|=|G|.
  \]
  Therefore $G=NH$.
\end{proof}

\begin{optional}
In his doctoral thesis Thompson proved the following result, conjectured
by Frobenius. 

\begin{theorem}[Thompson]
\index{Thompson theorem}
    Let $G$ be a Frobenius group. If $N$ is the Frobenius kernel, then $N$ 
    is nilpotent.
\end{theorem}

See~\cite[Theorem 6.24]{MR2426855} for the proof.
\end{optional}

\subsection{The Cameron--Cohen theorem (again)}

In this section, we use Frobenius’ theorem to strengthen the Cameron--Cohen theorem on derangements (Theorem~\ref{thm:CameronCohen}). To do so, we first require an alternative version of Frobenius’ theorem.

% Luca: 
% I feel like we should split corollary 9.4 into different cases. The case when G acts strictly transitive because then there exists no x \in X such that G_x is non-trivial (which is needed to obtain a Frobenius group), but in this case the set N formed by the identity and the derangements of G is completely G which is normal. The other case is the one you do in the proof, but you should mention that N is a normal subgroup not just a subgroup. Same for example 9.5 N is moreover a normal subgroup (which is the point of your example I think…)


\begin{corollary}[Frobenius]
    \label{cor:Frobenius_combinatorio}
    \index{Frobenius!theorem}
    Let $G$ be a group acting transitively on a finite set $X$. 
    Assume that each $g\in G\setminus\{1\}$ fixes 
    at most one element of 
     $X$. The set $N$ formed by the identity and the derangements 
     of $G$ is a normal subgroup of $G$.
\end{corollary}

\begin{proof}
  Let $x\in X$ and $H=G_x$. We claim that 
  if $g\in G\setminus H$, then $H\cap
  gHg^{-1}=\{1\}$. If $h\in H\cap gHg^{-1}$, then
  $h\cdot x=x$ and $(g^{-1}hg)\cdot
  x=x$. Since $g\cdot x\ne x$, $h$ fixes two elements of
  $X$. Thus 
  $h=1$, as every non-trivial element fixes at most one element of $X$. 

  By Theorem~\ref{thm:Frobenius}, 
  \[
    N=\left(G\setminus\bigcup_{g\in G}gHg^{-1}\right)\cup\{1\}
  \]
  is a subgroup of $G$. Let us compute the elements of $N$. If 
  $h\in\bigcup_{g\in G}gHg^{-1}$, then there exists  $g\in G$ such that $g^{-1}hg\in H$,
  that is $(g^{-1}hg)\cdot x=x$; equivalently, 
  $h\in G_{g\cdot x}$. Therefore, the 
  non-identity elements of $N$ are the elements of $G$
  moving every element of $X$.
\end{proof}

\begin{example}
  Let $F$ be a finite field and $G$ be the group of maps 
  $f\colon F\to F$ of the form 
  $f(x)=ax+b$, $a,b\in F$ with $a\ne0$. The group $G$ acts on 
  $F$ and every 
  $f\ne\id$ fixes at most one element of $F$, as 
  \[
	x=f(x)=ax+b\implies a\ne 1\text{ and } x=b/(1-a).
  \]
  In this case, $N=\{f:f(x)=x+b\,,b\in F\}$ 
  is a subgroup of $G$.
\end{example}

\begin{exercise}
    Prove that Theorem~\ref{thm:Frobenius} can be obtained from
    Corollary~\ref{cor:Frobenius_combinatorio}.
\end{exercise}

Using Frobenius’ theorem (Corollary~\ref{cor:Frobenius_combinatorio}), we can present a refinement of the Cameron–Cohen theorem.

% Wielandt 8.5.4
% 8.5.6 para ver algo de grupos de permutaciones
% 7.1 para ejemplo H(q)
% 10.5.6 (Thompson) N es nilpotente, se usa 10.5.4 

\begin{theorem}[Cameron--Cohen]
\index{Cameron--Cohen!theorem}
\label{thm:CameronCohen>1/n}
    Let $G\leq\Sym_n$ be a transitive subgroup. 
    If $n$ is not the power of a prime number, then
    $c_0>\frac{1}{n}$. 
\end{theorem}

\begin{proof}
    Let us go back to the proof
    of Theorem~\ref{thm:CameronCohen}. Assume that 
    $c_0=1/n$. Then
    \[
    \frac{1}{|G|}\sum_{g\in G}(\chi(g)^2-(n+1)\chi(g)+n)=1
    \]
    and hence $\frac{1}{|G|}\sum_{g\in G}\chi(g)^2=2$. Moreover, 
    since 
    \[
    \frac{1}{|G|}\sum_{g\in G_0}(\chi(g)-1)(\chi(g)-n)
    +\frac{1}{|G|}\sum_{g\in G\setminus G_0}(\chi(g)-1)(\chi(g)-n)=1,
    \]
    it follows that 
    \[
    \sum_{g\in G\setminus G_0}(\chi(g)-1)(\chi(g)-n)=0.
    \]
    Hence $(\chi(g)-1)(\chi(g)-n)=0$
    for all $g\in G\setminus G_0$. 
    
    By Corollary~\ref{cor:Frobenius_combinatorio}, 
    the subset $N=G_0\cup\{\id\}$ is a normal subgroup of $G$. Moreover, $G=N\rtimes H$ for some 
    subgroup $H$ of $G$ of order $n$. Since 
    $n=|H|=|N|-1$, $H$ acts freely and transitively 
    on $N\setminus\{1\}$. 

    We claim that $N$ is a $p$-group for some prime number $p$. Let $n,m\in N\setminus\{1\}$. Since $H$ is transitive on $N\setminus\{1\}$, 
    there exists $h\in H$ such that $h\cdot n=m$. Then
    \[
    |n|=|h\cdot n|=|m|,
    \]
    since for each $h\in H$, the map 
    $x\mapsto h\cdot x$ is an automorphism of $N$. Thus every two elements of $N\setminus\{1\}$ have 
    the same order. Let $p$ be a prime divisor 
    of $|N|$. By Cauchy's theorem, there exists 
    $n\in N$ such that $|n|=p$. Since all non-trivial
    elements of $N$ have the same order, 
    $N$ is a $p$-group. Therefore 
    $n=|N|$ is a power of a prime.
\end{proof}


\begin{exercise}
\label{xca:Frobenius_size20}
Let $G$ be the group of matrices 
of the form $\begin{pmatrix}a&b\\0&1\end{pmatrix}$ where $a,b\in\Z/5$ and $a\ne 0$. Then $|G|=20$. Let 
\[
    h=\begin{pmatrix}
        2\\
        &1
    \end{pmatrix},\quad 
    k=\begin{pmatrix}
        1&1\\
        &1
    \end{pmatrix}.
\]
A direct calculation shows that 
$h^4=1$, $k^5=1$ and $hkh^{-1}=k^2$. Let $H=\langle h\rangle$ 
and $K=\langle k\rangle$. Prove the following statements: 

\begin{enumerate}
    \item Prove that $G=K\rtimes H$.
    \item Find the conjugacy classes of $G$: 
\begin{center}
        \begin{tabular}{cccccc}
             Size & $1$ & $4$ & $5$ & $5$ & $5$\\
             \hline 
             Representative & $1$ & $k$ & $h$ & $h^2$ & $h^3$\\
        \end{tabular}
\end{center}
\item Prove that $G/K$ is cyclic of order four. 
\item Prove that $[G,G]=K$. 
\item Use Theorem~\ref{thm:correspondence} on $G/K$ 
    to find the degree-one characters of $G$. 
\item Let $\chi\in\Irr(K)$ be such that $\chi(k)=\exp(2\pi i/5)$. Prove that 
$\Ind_K^G\chi\in\Irr(G)$. 
\end{enumerate}
\end{exercise}

The previous exercise demonstrates that the character table of the 
Frobenius group of order $20$ corresponds to that of Table~\ref{tab:F5,4}.

\index{Character table!of $F_{5,4}$}
\begin{table}[ht]
\caption{Character table of the Frobenius group $F_{5,4}$ of order $20$.}
\label{tab:F5,4}
        \begin{tabular}{|c|ccccc|}
             \hline
             & $1$ & $k$ & $h$ & $h^2$ & $h^3$\\
             \hline
             $\chi_1$ & $1$ & $1$ & $1$ & $1$ & $1$\\
             $\chi_2$ & $1$ & $1$ & $i$ & $-1$ & $-i$\\
             $\chi_3$ & $1$ & $1$ & $-1$ & $1$ & $-1$\\
             $\chi_4$ & $1$ & $1$ & $-i$ & $-1$ & $i$\\
             $\chi_5$ & $4$ & $-1$ & $0$ & $0$ & $0$\\
             \hline
        \end{tabular}
    \end{table} 

\subsection{Burnside's theorem on real characters}

For $n\geq1$ let $\{e_1,\dots,e_n\}$ be the standard basis of $\C^n$.  
The \emph{natural representation} of $\Sym_n$ is 
$\rho\colon\Sym_n\to\GL_n(\C)$, $\sigma\mapsto\rho_{\sigma}$, 
where $\rho_\sigma(e_j)=e_{\sigma(j)}$ for all $j\in\{1,\dots,n\}$. 
The matrix of $\rho_\sigma$ in the standard basis is  
\begin{equation}
    \label{eq:Sn_natural}
    (\rho_\sigma)_{ij}=\begin{cases}
      1 & \text{if $i=\sigma(j)$},\\
      0 & \text{otherwise}.
    \end{cases}
\end{equation}

\begin{lemma}
	\label{lem:permutaciones}
	For $n\geq1$ let $\rho\colon\Sym_n\to\GL_n(C)$ be the natural 
	representation of the symmetric group. 
	If $A\in\C^{n\times n}$ and $\sigma\in\Sym_n$, then
	\[
		A_{ij}=(\rho_{\sigma}A)_{\sigma(i)j}=(A\rho_{\sigma})_{i\sigma^{-1}(j)}
	\]
    for all $i,j\in\{1,\dots,n\}$.
\end{lemma}

\begin{proof}
	With~\eqref{eq:Sn_natural} we compute:
	\[
		(A\rho_{\sigma})_{ij}=\sum_{k=1}^n A_{ik}(\rho_{\sigma})_{kj}=A_{i\sigma(j)},
		\quad
		(\rho_\sigma A)_{ij}=\sum_{k=1}^n (\rho_\sigma)_{ik}A_{kj}=A_{\sigma^{-1}(i)j}.\qedhere
	\]
\end{proof}

\begin{definition}
  \index{Real!character}
  Let $G$ be a finite group. A character $\chi$ of $G$ is said to be
  \emph{real} if
  $\chi=\overline{\chi}$, that is $\chi(g)\in\R$ for all $g\in G$. 
\end{definition}

\begin{exercise}
	\label{xca:chi_irreducible}
	Let $G$ be a finite group. If $\chi\in\Irr(G)$, then 
	$\overline{\chi}$ is irreducible.
\end{exercise}

\begin{definition}
  \index{Real!conjugacy class}
  Let $G$ be a group. A conjugacy class $C$ of $G$ is said to be
  \emph{real} if for every $g\in C$ one has $g^{-1}\in C$. 
\end{definition}

We use the following notation: if $G$ is a group and $C=\{xgx^{-1}:x\in G\}$ is a conjugacy class of  
$G$, then $C^{-1}=\{xg^{-1}x^{-1}:x\in G\}$.  

\begin{theorem}[Burnside]
    \index{Burnside!theorem on real characters}
    Let $G$ be a finite group. The number of real conjugacy classes 
    equals the number of real irreducible characters. 
\end{theorem}

\begin{proof}
  Let $C_1,\dots,C_r$ be the conjugacy classes of $G$ and  
  let $\chi_1,\dots,\chi_r$ be the irreducible characters of $G$. 
  Let $\alpha,\beta\in\Sym_r$ be such that $\overline{\chi_i}=\chi_{\alpha(i)}$ and 
  $C_i^{-1}=C_{\beta(i)}$ for all $i\in\{1,\dots,r\}$. Note that $\chi_i$
  is real if and only if $\alpha(i)=i$ and that $C_i$ is real if and only if 
  $\beta(i)=i$. The number $n$ of fixed points of $\alpha$ is equal to the number
  of real irreducible characters of $G$, and the number $m$ of fixed points of $\beta$ is equal
  to the number of real classes. 
  Let $\rho\colon\Sym_r\to\GL_r(\C)$ be the natural representation of $\Sym_r$, with character $\chi_\rho$.
  Then $\chi_\rho(\alpha)=n$ and $\chi_\rho(\beta)=m$. 
  
  We claim that 
  $\trace\rho_\alpha=\trace\rho_\beta$. Let $X=(\chi_i(C_j))\in\GL_r(\C)$ be the character matrix of $G$. 
  Then 
  \[
	\rho_\alpha X=\overline{X}=X\rho_\beta.
  \]
  For example, using Lemma~\ref{lem:permutaciones}, 
  \[
  \overline{X_{ij}}=\overline{\chi_i(C_j)}
  =\chi_i(C_j^{-1})=\chi_i(C_{\beta(j)}=X_{i\beta(j)}=(X\rho_\beta)_{ij}.
  \]
  
  Since $X$ is invertible, $\rho_{\alpha}=X\rho_{\beta}X^{-1}$. Thus 
  \[
    n=\chi_{\rho}(\alpha)=\trace\rho_{\alpha}=\trace\rho_{\beta}=\chi_{\rho}(\beta)=m.\qedhere
  \]
\end{proof}

\begin{corollary}
  \label{corollary:|G|impar}
  Let $G$ be a finite group. Then $|G|$ is odd if and only if
  the only real $\chi\in\Irr(G)$ is the trivial character. 
\end{corollary}

\begin{proof}
    If $|G|$ is even, there exists 
    $g\in G$ of order two (Cauchy's theorem). The conjugacy class of $g$ 
    is real. 

    Conversely, assume that $G$ has a non-trivial 
    real conjugacy class $C$. Let $g\in C$. We claim that 
    $G$ has an element of even order. Let $h\in G$ be such that
    $hgh^{-1}=g^{-1}$. Then $h^2\in C_G(g)$, as $h^2gh^{-2}=g$. 
    If $h\in\langle h^2\rangle\subseteq C_G(g)$, then $g$ has 
    even order, as $g^{-1}=g$. If $h\not\in\langle h^2\rangle$, then 
    $h^2$ does not generate $\langle h\rangle$. Hence $h$ has even order, 
    as $|h|\ne|h^2|=|h|/\gcd(|h|,2)$, so $\gcd(|h|,2)\ne 1$.  
\end{proof}

\begin{theorem}[Burnside]
  \index{Burnside!theorem}
  \label{thm:Burnside_mod16}
  Let $G$ be a finite group of odd order 
  with $r$ conjugacy classes. Then
  $r\equiv|G|\bmod{16}$.
\end{theorem}

\begin{proof}
  Since $|G|$ is odd, every non-trivial $\chi\in\Irr(G)$ is not real by
  the previous corollary. The irreducible characters 
  of $G$ are  
  \[
    \chi_1,\chi_2,\overline{\chi_2},\dots,\chi_k,\overline{\chi_k},
    \quad
    r=1+2(k-1),
  \]
  where $\chi_1$ denotes the trivial character. 
  For every $j\in\{2,\dots,k\}$ let $d_j=\chi_j(1)$. 
  Since each $d_j$ divides 
  $|G|$ by Frobenius' theorem and  $|G|$ is odd, 
  every $d_j$ is an odd number, 
  say $d_j=1+2m_j$. Thus  
  \begin{align*}
    |G|&=1+\sum_{j=2}^k 2d_j^2=1+\sum_{j=2}^k2(2m_j+1)^2\\
    &=1+\sum_{j=2}^k2(4m_j^2+4m_j+1)
    =1+2(k-1)+8\sum_{j=2}^km_j(m_j+1).
  \end{align*}
  Hence $|G|\equiv r\bmod{16}$, 
  as $r=1+2k$ and every $m_j(m_j+1)$ is even. 
\end{proof}

As an immediate consequence of Theorem~\ref{thm:Burnside_mod16}, we conclude that every group of order 15 is abelian.

\subsection{The character table of $\PSL_2(7)$}

Let 
\[
G=\PSL_2(7)=\SL_2(7)/Z(\SL_2(7)).
\]
Let $K=Z(\SL_2(7))$. 
Then $K=\{I,-I\}$, where $I$ denotes the $2\times 2$ identity
matrix with coefficients in the field of seven elements. 
$|G|=168$. We compute the
character table of $G$. 

\begin{exercise}
    The group $G$ has six conjugacy classes with representatives
    $g_1K,\dots,g_6K$, where 
    \begin{align*}
    &g_1=\begin{pmatrix}
         1&0\\
         0&1
         \end{pmatrix},
    &&g_2=\begin{pmatrix}
         0&1\\
         -1&0
         \end{pmatrix},
    &&g_3=\begin{pmatrix}
         2&-2\\
         2&2
         \end{pmatrix},\\
    &g_4=\begin{pmatrix}
         2&0\\
         0&4
         \end{pmatrix},
    &&g_5=\begin{pmatrix}
         1&1\\
         0&1
         \end{pmatrix},
    &&g_6=\begin{pmatrix}
         1&-1\\
         0&1
         \end{pmatrix}.
    \end{align*}
    Moreover, prove that size of each conjugacy class is given in Table~\ref{tab:cc:PSL(2,7)}
\end{exercise}

For example, for computing the conjugacy class
of $g_4$, we note that if 
\[
\begin{pmatrix}
    a&b\\
    c&d
\end{pmatrix}g_4=\pm g_4\begin{pmatrix}
    a&b\\
    c&d
\end{pmatrix},
\]
then $b=c=0$. Thus 
\[
C_G(g_4)=\left\{\pm\begin{pmatrix}
    1&0\\
    0&1
\end{pmatrix},\pm\begin{pmatrix}
    2&0\\
    0&4
\end{pmatrix},\pm\begin{pmatrix}
    4&0\\
    0&2
\end{pmatrix}\right\}.
\]
Thus $|C_G(g_4)|=6$ and 
hence the conjugacy class of $g_4$ has 42 elements. 

\begin{table}[ht]
    \caption{Conjugacy classes of $\PSL_2(7)$.}
    \begin{tabular}{|c|c|c|}
        \hline 
        Representative & Order & Size  \\
        \hline 
         $g_1K$ & 1 & 1 \\
         $g_2K$ & 2 & 21 \\
         $g_3K$ & 4 & 42\\
         $g_4K$ & 3 & 56 \\
         $g_5K$ & 7 & 24 \\
         $g_6K$ & 7 & 24 \\
         \hline 
    \end{tabular}
    \label{tab:cc:PSL(2,7)}.
\end{table}

\begin{exercise}
    Use the information in Table~\ref{tab:cc:PSL(2,7)}
    to prove that $\PSL_2(7)$ is a simple group. 
\end{exercise}

\begin{proposition}
    Let $\chi\in\Irr(G)$. Then $\chi(g_jK)\in\Z$ for all 
    $j\in\{1,2,3,4\}$ and $\chi(g_5K)\not\in\R$. 
\end{proposition}

\begin{proof}
    Let $j\in\{1,2,3,4\}$. Since 
    $g_jK$ is conjugate to some $g_j^kK$
    when they both have the same order...   
    
    Since $g_6K=g_5^{-1}K$, it follows
    that $g_5K$ is not conjugate to its inverse. Thus 
    the class of $g_5K$ is not real and hence 
    $\chi(g_5K)\not\in\R$. 
\end{proof}

\begin{proposition}
    Let 
    \[
    T=\left\{\begin{pmatrix}
        a&b\\
        0&a^{-1}
        \end{pmatrix}
        :a\in\Z/7\setminus\{0\},
        b\in\Z/7\right\}.
    \]
    
\end{proposition}